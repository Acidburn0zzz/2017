<!DOCTYPE html>
<html lang='en'>
<head>
  <!-- $title:Ind.ie Pulse Blog — Dockerising the Pulse Discovery Service-->
  <!-- @import '../../../assets/includes/head.kit' -->
  <link rel='stylesheet' type='text/css' href='css/style.css'>
</head>
<body class='pulse-blog article'>
  <header class='site-header'>
    <!-- @import '../../../assets/includes/nav.kit' -->
    <!-- @import '../../includes/nav.kit' -->
  </header>

  <div class='main h-entry'>
    <h1 class='p-name'>Dockerising the Pulse Discovery Service</h1>

    <p class='post-date dt-published' datetime="2014-11-17 16:30:00">17th November, 2014 — <span class='p-author'>George MacRorie</span></p>
    <div class='e-content'>
      <p>
        Hello, I'm George and I am in the process of joining the Ind.ie team to work on Pulse.
        Until then I will, and have been, doing some work in my spare time to get Pulse ready for the public.
        As some of you may know, Pulse is an officially sanctioned fork of Syncthing. For the immediate future, it will remain this way.
        I will be working to keep core security/protocols up to date with Syncthing.
        However, in the not so distance future, we will inevitably diverge as we tailor Pulse for the indienet.
      </p>
      <p>
        The Pulse blog is a space for what Pulse can do, where Pulse is going and what we have learnt building a distributed filesystem.
        So I thought I would kick things off by talking about the Pulse discovery service.
        The Pulse discovery service is a Go service, used to match up your pulse device ID with your IP address.
        This is how Pulse identifies other devices. It is also a fork of a Syncthing project <a href="http://github.com/syncthing/discosrv">syncthing/discosrv</a>, now
        being developed in our Gitlab at <a href="http://source.ind.ie/project/disocsrv">ind.ie/discosrv</a>.
      </p>
      <p>
        My first change to discosrv was to vendor the dependencies using the Godep tool for Go. This allows me to lock down versions of leveldb, groupcache and so on.
        Secondly, I introduced Docker. For those of you that don't know Docker, Docker is a way for building, versioning and shipping linux containers.
        Using the official Golang base images, found here <a href="https://registry.hub.docker.com/_/golang/">golang images</a>, I contained discosrv and a set of
        commonly used startup options (thanks to the advice of <a href="http://github.com/calmh">Jakob Borg</a>). This allows for super easy deployment.
        Just <code>docker pull indie/discosrv</code> and <code>docker run indie/discosrv</code>. You will need to expose a port for discosrv to communicate over and I recommend mounting a volume 
        for persisting the leveldb and statistics data. For example, <code>docker run -v /var/discosrv:/var/discosrv -p 22026:22026 indie/discosrv</code>.
        Here I have mounted '/var/discosrv' directory from the host machine in to the container and exposed the discosrv udp port 22026 on to the host machine.
      </p>
      <p>
        Indie official discovery service docker image: <a href="https://registry.hub.docker.com/u/indie/discosrv/">indie/discosrv</a>.
        Currently used by the first distributions of Pulse.
      </p>
    </div>
    <!-- @import '../../../assets/includes/footer-call-to-action.kit' -->
<!-- @import '../../../assets/includes/footer.kit' -->
  </div>
</body>
</html>
